<!-- 引入文件 -->
<html>
<head>
    <meta charset="UTF-8">
    <title>我的信息</title>
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style" />
    <meta content="telephone=no" name="format-detection" />
   
    <!-- 引入YDUI样式 -->
    <link rel="stylesheet" href="../frame/ydui-0.1.3/build/css/ydui.css" />
    <link rel="stylesheet" href="../font/iconfont2.css">
    <link rel="stylesheet" href="../css/updata.css">
    <link rel="stylesheet" href="../css/bootstrap.css">
    <!-- 引入YDUI自适应解决方案类库 -->
    <script src="../frame/ydui-0.1.3/build/js/ydui.flexible.js"></script>
</head>
<body>
    <header class="m-navbar borders">
        <a href="#" class="navbar-item" onclick=back()>
            <i class="back-ico"></i>
        </a>
        <div class="navbar-center">
            <span class="navbar-title">我的资料</span>
        </div>
      
    </header>

    <div class="bg">
<div class="m-cell margin10 nok">
       
        <a class="cell-item linehe" href="javascript:;" id="J_ShowActionSheet">
                <div class="cell-left"><i class="cell-icon icon-ucenter-outline"></i>头像</div>
                <div class="headkk">
                    <img src="../img/headimg.png" alt="" class="jisoeiioo">
                </div>
                <div class="cell-right cell-arrow"></div>
            
            </a>
    <a class="cell-item upunikename" href="javascript:;">
        <div class="cell-left"><i class="cell-icon icon-order"></i>用户名</div>
        <div class="cell-right cell-arrow usernikenn"></div>
    </a>
    <a class="cell-item" href="javascript:;">
        <div class="cell-left"><i class="fsdfw iconfont">&#xe7c5;</i>生日</div>
        <div class="cell-right cell-arrow"></div>
    </a>
    <a class="cell-item" href="./locationus.html">
            <div class="cell-left"><i class="cell-icon icon-location"></i>管理收货地址</div>
            <div class="cell-right cell-arrow"></div>
        </a>
</div>
<div class="m-cell margin10 nok">
      
    <a class="cell-item sexup" href="javascript:;">
        <div class="cell-left"><i class="fsdfw iconfont">&#xe7f8;</i>性别</div>
        <div class="cell-right cell-arrow sexus"></div>
    </a>
    <a class="cell-item upjianjie" href="javascript:;">
        <div class="cell-left"><i class="fsdfw iconfont">&#xe7a1;</i>简介</div>
        <div class="cell-right cell-arrow userjja"></div>
    </a>
</div>
<div class="m-cell margin10 nok" >
        
    <a class="cell-item" href="javascript:;">
        <div class="cell-left"><i class="cell-icon icon-shield"></i>安全</div>
        <div class="cell-right cell-arrow">设置</div>
    </a>
    <a class="cell-item" href="javascript:;">
        <div class="cell-left"><i class="fsdfw iconfont">&#xe7e5;</i>第三方账号绑定</div>
        <div class="cell-right cell-arrow"></div>
    </a>

</div>
<div class="m-actionsheet" id="J_ActionSheet">
        <input type="file" id="xiangce" style="display:none" onchange=fsfkue(this)>
        <label for="xiangce" class="actionsheet-item">从相册选择</label>
        <a href="#" class="actionsheet-item">随便来一张</a>
        <a href="#" class="actionsheet-item">官方头像</a>
        <a href="javascript:;" class="actionsheet-action" id="J_Cancel">取消</a>
    </div>
<input type="text" id="nike" class="disno">


<script src="../js/gong.js"></script>

    <!-- 引入jQuery 2.0+ -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- 引入YDUI脚本 -->
<script src="../frame/ydui-0.1.3/build/js/ydui.js"></script>
<!-- Bootstrap 4 requires Popper.js -->
<script src="https://unpkg.com/popper.js@1.14.1/dist/umd/popper.min.js" crossorigin="anonymous"></script>
</body>

    <script>
        var jiw = {

            // 1是查用户表
            type:1,
            qm:window.localStorage['signature']
        }
        $.ajax({
            type: "post",
            url: "http://localhost/phpbox/onlinepro/php/execute/chaxx.php",
            data: jiw,
            success: function (response) {
                console.log(response);
                var biaoa = JSON.parse(response);
                console.log(biaoa.data[0]);
                    $('.usernikenn').text(biaoa.data[0].name)
                    $('.sexus').text(biaoa.data[0].sex)
                    $('.userjja').text(biaoa.data[0].jianjie)
                    $('.headkk').html(`
                    
                    <img src=${biaoa.data[0].headimg} alt="">
                    `)
            }
        });
         
            // 更改用户名
$('.upunikename').on('touchend', function () {
   
        YDUI.dialog.confirm('<div class="jjijiw">更改昵称</div>', '<input type="text" onchange=jiow(this) class="form-control inputup" placeholder="填写你的昵称">', [
                {
                    txt: '再想想',
                    color: false, /* false:黑色  true:绿色 或 使用颜色值 */
                    callback: function () {
                 
                    }
                },
                {
                    txt: '确定更改',
                    color: true,
                    callback: function () {
                        // console.log($('#nike').val());
                        // 1传name 2传 性别 3 传简介

                        var str = {
                            type:1,
                            name:$('#nike').val(),
                            qm:window.localStorage['signature']
                        }
                        $.ajax({
                            type: "post",
                            url: "http://localhost/phpbox/onlinepro/php/execute/updtauser.php",
                            data: str,
                            success: function (response) {
                                console.log(response);
                                
                            }
                        });
                        YDUI.dialog.toast('更改成功', 'none', 1000);
                    }
                }
            ]);
        });


        $('.sexup').on("touchend",function () {
            YDUI.dialog.confirm('', '<label class="radio-inline"><button class="jisowsa" onclick=iiwwe(this)>男</button><input type="radio"name="inlineRadioOptions"id="inlineRadio1"value="男"class=""></label><label class="radio-inline"><button class="jisowsa" onclick=iiwwe(this)>女</button><input type="radio"name="inlineRadioOptions"id="inlineRadio2"value="女"></label><label class="radio-inline"><button class="jisowsa" onclick=iiwwe(this)>保密</button><input type="radio"name="inlineRadioOptions"id="inlineRadio3"value="保密"></label>', [
                {
                    txt: '不告诉你',
                    color: false, /* false:黑色  true:绿色 或 使用颜色值 */
                    callback: function () {
                      
                    }
                },
                {
                    txt: '确定',
                    color: true,
                    callback: function () {
                        console.log($('#nike').val());
                        // 1传name 2传 性别 3 传简介

                        var str = {
                            type:2,
                            sex:$('#nike').val(),
                            qm:window.localStorage['signature']
                        }
                        $.ajax({
                            type: "post",
                            url: "http://localhost/phpbox/onlinepro/php/execute/updtauser.php",
                            data: str,
                            success: function (response) {
                                console.log(response);
                                
                            }
                        });
                        YDUI.dialog.toast('更改成功', 'none', 1000);
                    }
                }
            ]);
        })

        $('.upjianjie').on("touchend",function () {
            YDUI.dialog.confirm('<div class="jjijiw">世界这么大，我想去看看</div>', '<div class="m-cell nok"><div class="cell-item"><div class="cell-right"><textarea class="cell-textarea"placeholder="写下你的人生格言吧" onchange=jiow(this)></textarea></div></div></div>', [
                {
                    txt: '再想想',
                    color: false, /* false:黑色  true:绿色 或 使用颜色值 */
                    callback: function () {
                      
                    }
                },
                {
                    txt: '确定更改',
                    color: true,
                    callback: function () {
                        console.log($('#nike').val());
                        // 1传name 2传 性别 3 传简介

                        var str = {
                            type:3,
                            jj:$('#nike').val(),
                            qm:window.localStorage['signature']
                        }
                        $.ajax({
                            type: "post",
                            url: "http://localhost/phpbox/onlinepro/php/execute/updtauser.php",
                            data: str,
                            success: function (response) {
                                console.log(response);
                                
                            }
                        });
                        YDUI.dialog.toast('更改成功', 'none', 1000);
                    }
                }
            ]);
            
        })
      function jiow(eq) {
          $('#nike').val(eq.value)}
          function iiwwe(eq) {
              $('.jisowsa').css({"border": "2px solid rgb(204, 204, 204)"})
              eq.style.cssText="border:2px solid red"
              $('#nike').val(eq.innerText) 
            
          }
          function back() {
              history.back()
          }


// 上拉菜单
          var $as = $('#J_ActionSheet');

    $('#J_ShowActionSheet').on('click', function () {
        $as.actionSheet('open');
    });

    $('#J_Cancel').on('click', function () {
        $as.actionSheet('close');
    });

    /* 自定义事件 */
    $as.on('open.ydui.actionsheet', function () {
        console.log('打开了');
    }).on('close.ydui.actionsheet', function () {
        console.log('关闭了');
    });


    function fsfkue(file) {
    var    formdata = new FormData();
   var pic = file.files[0]
            formdata.append("headimg",pic)
            formdata.append("type",5)
            formdata.append("qm",window.localStorage['signature'])
            $.ajax({
                type: "post",
                url: "http://localhost/phpbox/onlinepro/php/execute/updtauser.php",
                data: formdata,
                processData:false,
                contentType:false,
                success: function (response) {
                   console.log(response);
                   $as.actionSheet('close');
                }
            });
   console.log(pic);
  // FileRender类  渲染类
  var reader = new FileReader();
  reader.readAsDataURL(pic)
   console.log(reader)
   reader.onload = function(){


  var fdsfe = document.querySelector('.headkk')
     
       fdsfe.innerText = ""
    var img = document.createElement('img');
    img.className = "girjogior"
    img.src = this.result
    fdsfe.appendChild(img)
     
   }
    }
    </script>
</html>



