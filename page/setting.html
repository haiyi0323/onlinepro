<!-- 引入文件 -->
<html>
<head>
    <meta charset="UTF-8">
    <title>设置</title>
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style" />
    <meta content="telephone=no" name="format-detection" />
   
    <!-- 引入YDUI样式 -->
    <link rel="stylesheet" href="../frame/ydui-0.1.3/build/css/ydui.css" />
    <link rel="stylesheet" href="../css/dfjiiooow.css">
   <link rel="stylesheet" href="../css/bootstrap.css">

    <!-- 引入YDUI自适应解决方案类库 -->
    <script src="../frame/ydui-0.1.3/build/js/ydui.flexible.js"></script>
</head>
<body>
    <header class="m-navbar">
        <a href="#" class="navbar-item" onclick=back()>
            <i class="back-ico"></i>
        </a>
        <div class="navbar-center">
            <span class="navbar-title">设置</span>
        </div>
        
    </header>
    <!-- ----------------------------------- -->
    
<div class="m-cell sdgsdsdf">
        <a class="cell-item" href="javascript:;" id="J_OpenKeyBoard" >
                <div class="cell-left"><i class="cell-icon icon-shield-outline"></i>设置支付密码</div>
                <div class="cell-right cell-arrow"></div>
            </a>
    <a class="cell-item" href="javascript:;" onclick=tuichu()>
        <div class="cell-left"><i class="cell-icon icon-error-outline"></i>安全退出</div>
        <div class="cell-right cell-arrow sdfsdfgfdh"></div>
    </a>
</div>



    <div class="jiiijj" onclick= jiowo()></div>
<div class="m-keyboard" id="J_KeyBoard">
        <!-- 自定义内容区域 -->
        <div style="text-align: right;padding: .15rem .8rem 0;"><a href="http://www.ydui.org" style="color: #666;font-size: .24rem;">忘记密码</a></div>
        <!-- 自定义内容区域 -->
    </div>

    <div class="m-keyboard" id="J_KeyBoard2">
            <!-- 自定义内容区域 -->
            <div style="text-align: right;padding: .15rem .8rem 0;"><a href="http://www.ydui.org" style="color: #666;font-size: .24rem;">忘记密码</a></div>
            <!-- 自定义内容区域 -->
        </div>




        <div class="m-keyboard" id="J_KeyBoard3">
                <!-- 自定义内容区域 -->
                <div style="text-align: right;padding: .15rem .8rem 0;"><a href="http://www.ydui.org" style="color: #666;font-size: .24rem;">忘记密码</a></div>
                <!-- 自定义内容区域 -->
            </div>

<script src="../js/gong.js"></script>
    <!-- 引入jQuery 2.0+ -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- 引入YDUI脚本 -->
<script src="../frame/ydui-0.1.3/build/js/ydui.js"></script>
<!-- Bootstrap 4 requires Popper.js -->
<script src="https://unpkg.com/popper.js@1.14.1/dist/umd/popper.min.js" crossorigin="anonymous"></script>
</body>


    <script>
var userid;

        $.ajax({
            type: "post",
            url: "http://localhost/phpbox/onlinepro/php/execute/dzsj.php",
            data: {type:888,qm:window.localStorage['signature']},
         
            success: function (response) {
               window.userid = JSON.parse(response) 

              chaif()

              
            }
        });

function chaif(){
    $.ajax({
            type: "post",
            url: "http://localhost/phpbox/onlinepro/php/execute/zhifu.php",
            data: {type:2,userid:userid},
            success: function (response) {
                console.log(response);
                var jioi = JSON.parse(response)
                if (jioi.data.length >0) {

                    $('#J_OpenKeyBoard').remove()
                    console.log(888);

                    var xiugmm = $('<a>')
                            xiugmm.attr("class","cell-item")
                            xiugmm.attr("id","xiugmm")
                            xiugmm.attr("href","javascript:;")
                            xiugmm.html(
                                `
                                <div class="cell-left"><i class="cell-icon icon-shield-outline"></i>修改支付密码</div>
                <div class="cell-right cell-arrow"></div>
                                `
                            )

                    $('.sdgsdsdf').prepend(xiugmm)
                    
                }
                
var $keyboard = $('#J_KeyBoard2');

/* 初始化参数 */
$keyboard.keyBoard({
    disorder: false, /* 是否打乱数字顺序 */
    title: '图兰简芮安全键盘' /* 显示标题 */
});

/* 打开键盘 */
$('#xiugmm').on('click', function () {
    $keyboard.keyBoard('open');
    YDUI.dialog.toast('请输入您旧密码', 'none', 1000);
});

/* 六位密码输入完毕后执行 */
$keyboard.on('done.ydui.keyboard', function (ret) {

    $.ajax({
        type: "post",
        url: "http://localhost/phpbox/onlinepro/php/execute/zhifu.php",
        data: {type:263,userid:userid,pas:ret.password},
        success: function (response) {
            console.log(response);
            var iidis = JSON.parse(response);
            if (iidis.data.length>0) {
                $('.jiiijj').click()
            }else{
                YDUI.dialog.loading.close();
        $keyboard.keyBoard('error', '对不起，您的支付密码不正确，请重新输入。');
            }
        }
    });





 
        /* 显示错误信息 */
      

        YDUI.dialog.toast('验证成功，请设置新密码', 'none', 1000);
    /* 关闭键盘 */
    setTimeout(() => {
        $keyboard.keyBoard('close');
    }, 1000);
});
    


            }
        });

        
}
       
function jiowo() {
    console.log(5556);
    
}











// -----------------------------------------------------------------
     var $keyboard = $('#J_KeyBoard');

/* 初始化参数 */
$keyboard.keyBoard({
    disorder: false, /* 是否打乱数字顺序 */
    title: 'YDUI安全键盘' /* 显示标题 */
});

/* 打开键盘 */
$('#J_OpenKeyBoard').on('click', function () {
    $keyboard.keyBoard('open');
});

/* 六位密码输入完毕后执行 */
$keyboard.on('done.ydui.keyboard', function (ret) {

    $.ajax({
        type: "post",
        url: "http://localhost/phpbox/onlinepro/php/execute/zhifu.php",
        data: {type:1,userid:userid,pas:ret.password},
        success: function (response) {
            console.log(response);
            
        }
    });



    

    YDUI.dialog.toast('设置成功', 'none', 1000);
    setTimeout(() => {
        location.reload()
    }, 1000);
   

    /* 关闭键盘 */
    setTimeout(() => {
        $keyboard.keyBoard('close');
    }, 1000);

});

// ---------------------------------------------------------

var $keyboard = $('#J_KeyBoard3');

/* 初始化参数 */
$keyboard.keyBoard({
    disorder: false, /* 是否打乱数字顺序 */
    title: 'YDUI安全键盘' /* 显示标题 */
});

/* 打开键盘 */
$('.jiiijj').on('click', function () {
    $keyboard.keyBoard('open');
});

/* 六位密码输入完毕后执行 */
$keyboard.on('done.ydui.keyboard', function (ret) {

    $.ajax({
        type: "post",
        url: "http://localhost/phpbox/onlinepro/php/execute/zhifu.php",
        data: {type:44,userid:userid,newpas:ret.password},
        success: function (response) {
            YDUI.dialog.toast('修改成功', 'none', 1000);
        }
    });
    setTimeout(function(){
        /* 显示错误信息 */
        YDUI.dialog.loading.close();
        $keyboard.keyBoard('error', '对不起，您的支付密码不正确，请重新输入。');
    }, 1500);

    /* 关闭键盘 */
     $keyboard.keyBoard('close'); 
});
    </script>
</html>



